---
layout: default
title: Upload XLSX
overview: true
---  

<ul class="toolbar">
    <li>{"<a href="data.json" title="JSON" target="_blank">data.json</a>"}</li>
</ul>  
<table cellpadding="0" cellspacing="0" width="100%" style="border: 0px solid #FFF;">
    <tr>
        <td width="75%" style="font-size: 18px; font-weight: bold;"><h2>Upload Excel File (XLSX)</h2></td>
        <td id="SaveButton" width="25%" style="font-size: 16px;" align="center"><a href="oauth.html"><strong>Login to Save</strong></a></td>
    </tr>
    <tr>
        <td id="FileName" style="font-size: 18px; font-weight: bold;" align="center" colspan="2"></td>
    </tr>    
</table>

<table cellpadding="5" cellspacing="5" width="100%">
    <tr>
        <td align="center" width="50%">
            <div id="upload">
                Upload Zone<br />
                <input type="file" onchange="readfile(this.files[0])" style="margin-top: 10px; border:0px;"></input>
            </div>
        </td>
        <td align="center" width="50%">
            <div id="drop">Drag & Drop Zone</div>   
        </td>
    </tr>
</table>
<div id="displayMe"><p align="center">Upload or Drag & Drop an Excel file (XLSX only), and it will generate JSON below.</p></a>
<table cellpadding="5" cellspacing="5" width="100%">
    <tr>
        <td align="left">
            <strong>JSON</strong>
            <textarea id="JSONView" style="height: 550px; width:100%; overflow: auto; border: 1px solid #000;"></textarea>
        </td>
    </tr>
</table>                    

<input type="hidden" name="oAuth_Token" id="oAuth_Token" value="" />
<input type="hidden" name="uploadfilename" id="uploadfilename" value="" />


<script>

    function to_json(workbook) {
        var result = {};
        workbook.SheetNames.forEach(function(sheetName) {
            var roa = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
            if(roa.length > 0){
                result[sheetName] = roa;
            }
        });
        return result;
    }
    
    function to_csv(workbook) {
        var result = [];
        workbook.SheetNames.forEach(function(sheetName) {
            var csv = XLSX.utils.sheet_to_csv(workbook.Sheets[sheetName]);
            if(csv.length > 0){
                result.push(csv);
            }
        });
        return result.join("\n");
    }
    
    function process_wb(wb) {
        
        var output = "";

       //$CSVOutput = to_csv(wb);                              
       //var $CSVViewer = document.getElementById("CSVView");
       //$CSVViewer.innerHTML = $CSVOutput;
       
       $JSONOutput = JSON.stringify(to_json(wb), 2, 2);
       var $JSONView = document.getElementById("JSONView");
       $JSONView.innerHTML = $JSONOutput;
    }    
    
    function readfile(f) {
        var reader = new FileReader();
        var name = f.name;
        
        document.getElementById("FileName").innerHTML = name.replace(".xlsx","");
        document.getElementById("uploadfilename").value = name.replace(".xlsx","");
        
        reader.onload = function(e) {
            var data = e.target.result;
            
            //var wb = XLSX.read(data, {type: 'binary'});
            var arr = String.fromCharCode.apply(null, new Uint8Array(data));
            var wb = XLSX.read(btoa(arr), {type: 'base64'});
            process_wb(wb);
            
        };
        //reader.readAsBinaryString(f);
        reader.readAsArrayBuffer(f);
    }
    
    var drop = document.getElementById('drop');
    function handleDrop(e) {
        e.stopPropagation();
        e.preventDefault();
        var files = e.dataTransfer.files;
        var i,f;
        for (i = 0, f = files[i]; i != files.length; ++i) {
            var reader = new FileReader();
            var name = f.name;
            
            document.getElementById("FileName").innerHTML = name.replace(".xlsx","");
            document.getElementById("uploadfilename").value = name.replace(".xlsx","");
            
            reader.onload = function(e) {
                var data = e.target.result;
                
                //var wb = XLSX.read(data, {type: 'binary'});
                var arr = String.fromCharCode.apply(null, new Uint8Array(data));
                var wb = XLSX.read(btoa(arr), {type: 'base64'});
                process_wb(wb);
                
            };
            //reader.readAsBinaryString(f);
            reader.readAsArrayBuffer(f);
        }
    }
    
    function handleDragover(e) {
        e.stopPropagation();
        e.preventDefault();
        e.dataTransfer.dropEffect = 'copy';
    }
    
    if(drop.addEventListener) {
        drop.addEventListener('dragenter', handleDragover, false);
        drop.addEventListener('dragover', handleDragover, false);
        drop.addEventListener('drop', handleDrop, false);
    }
</script>

<hr />
<!-- 3scale -->
<p align="center">
<a href="http://bit.ly/13esk6Q" target="_blank" title="APIs From 3Scale">
    <img src="https://s3.amazonaws.com/kinlane-productions/api-service-providers/3Scale/empowered-by-3scale.png" width="300" style="padding-bottom: 15px;" />
</a>        
</p>  